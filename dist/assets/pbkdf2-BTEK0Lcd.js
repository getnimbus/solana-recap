import{a2 as I,a3 as P,a4 as F,a5 as A,a6 as h,a7 as w,X as R}from"./Bridge.js";function g(u,y,d,l){F(u);const f=A({dkLen:32,asyncTick:10},l),{c:p,dkLen:i,asyncTick:t}=f;if(h(p),h(i),h(t),p<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const n=w(y),o=w(d),r=new Uint8Array(i),b=R.create(u,n),e=b._cloneInto().update(o);return{c:p,dkLen:i,asyncTick:t,DK:r,PRF:b,PRFSalt:e}}function _(u,y,d,l,f){return u.destroy(),y.destroy(),l&&l.destroy(),f.fill(0),d}function T(u,y,d,l){const{c:f,dkLen:p,DK:i,PRF:t,PRFSalt:n}=g(u,y,d,l);let o;const r=new Uint8Array(4),b=I(r),e=new Uint8Array(t.outputLen);for(let a=1,k=0;k<p;a++,k+=t.outputLen){const s=i.subarray(k,k+t.outputLen);b.setInt32(0,a,!1),(o=n._cloneInto(o)).update(r).digestInto(e),s.set(e.subarray(0,s.length));for(let L=1;L<f;L++){t._cloneInto(o).update(e).digestInto(e);for(let c=0;c<s.length;c++)s[c]^=e[c]}}return _(t,n,i,o,e)}async function U(u,y,d,l){const{c:f,dkLen:p,asyncTick:i,DK:t,PRF:n,PRFSalt:o}=g(u,y,d,l);let r;const b=new Uint8Array(4),e=I(b),a=new Uint8Array(n.outputLen);for(let k=1,s=0;s<p;k++,s+=n.outputLen){const L=t.subarray(s,s+n.outputLen);e.setInt32(0,k,!1),(r=o._cloneInto(r)).update(b).digestInto(a),L.set(a.subarray(0,L.length)),await P(f-1,i,()=>{n._cloneInto(r).update(a).digestInto(a);for(let c=0;c<L.length;c++)L[c]^=a[c]})}return _(n,o,t,r,a)}const D=Object.freeze(Object.defineProperty({__proto__:null,pbkdf2:T,pbkdf2Async:U},Symbol.toStringTag,{value:"Module"}));export{D,T};
