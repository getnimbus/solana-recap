{"version":3,"file":"Invitation.js","sources":["../../src/layouts/Invitation.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import { onMount } from \"svelte\";\n  import { getReferralInvitation } from \"~/lib/queryAPI\";\n  import { t } from \"~/lib/i18n\";\n  import QRCode from \"qrcode-generator\";\n  import CopyToClipboard from \"svelte-copy-to-clipboard\";\n  import html2canvas from \"html2canvas\";\n  import { shorterAddress } from \"~/utils/index\";\n  import { triggerToast } from \"~/utils/functions\";\n  import { createQuery } from \"@tanstack/svelte-query\";\n  import { isDarkMode, userId } from \"~/store\";\n  import { isNimbusVersion } from \"~/utils/constants\";\n\n  import ErrorBoundary from \"~/components/ErrorBoundary.svelte\";\n\n  import Logo from \"~/assets/logo-1.svg\";\n\n  const qrcode = QRCode(0, \"L\");\n\n  let link = \"\";\n  let qrImageDataUrl = \"\";\n  let referrals = 0;\n  let userAddress = \"\";\n\n  // query referrals\n  $: queryReferrals = createQuery({\n    queryKey: [\"referrals-invitation\"],\n    queryFn: () => getReferralInvitation(),\n  });\n\n  $: {\n    if (!$queryReferrals.isError && $queryReferrals.data !== undefined) {\n      referrals = $queryReferrals.data?.count;\n    }\n  }\n\n  onMount(() => {\n    const publicAddress = localStorage.getItem(\"public_address\");\n    userAddress = publicAddress;\n  });\n\n  $: {\n    if ($userId) {\n      link = `https://app.getnimbus.io/?invitation=${$userId}`;\n      qrcode.addData(link);\n      qrcode.make();\n      qrImageDataUrl = qrcode.createDataURL(6, 0);\n    }\n  }\n\n  const downloadQRCode = async () => {\n    const targetElement = document.getElementById(\"target-element\");\n    if (targetElement) {\n      try {\n        const canvas = await html2canvas(targetElement);\n        const img = canvas.toDataURL(\"image/png\");\n        // handle download image\n        const a = document.createElement(\"a\");\n        a.href = img;\n        a.download = \"qrcode.png\";\n        document.body.appendChild(a);\n        a.click();\n        document.body.removeChild(a);\n        triggerToast(\"Successfully downloaded QR!\", \"success\");\n      } catch (error) {\n        console.error(\"Error capturing screenshot:\", error);\n        triggerToast(\n          \"Something wrong when download QR. Please try again!\",\n          \"fail\",\n        );\n      }\n    }\n  };\n\n  const copyQRCode = async () => {\n    const targetElement = document.getElementById(\"target-element\");\n    if (targetElement) {\n      try {\n        const createCanvas = await html2canvas(targetElement);\n        const img = createCanvas.toDataURL(\"image/png\");\n        // handle copy image\n        const response = await fetch(img);\n        const blob = await response.blob();\n        await navigator.clipboard.write([\n          new ClipboardItem({ \"image/png\": blob }),\n        ]);\n        triggerToast(\"Successfully copied QR!\", \"success\");\n      } catch (error) {\n        console.error(\"Error capturing screenshot:\", error);\n        triggerToast(\"Something wrong when copy QR. Please try again!\", \"fail\");\n      }\n    }\n  };\n</script>\n\n<ErrorBoundary>\n  <div\n    class=\"xl:min-h-screen max-w-[1600px] m-auto w-[94%] py-8 flex flex-col gap-10\"\n  >\n    <div class=\"flex flex-col gap-2 justify-center\">\n      <div class=\"text-4xl font-semibold\">{$t(\"Invite Friends\")}</div>\n      <div class=\"text-xl\">\n        {$t(\"Tell your friends\")} <br />\n        {$t(\"Easy way\")}\n      </div>\n    </div>\n    <div class=\"sm:min-w-xl flex justify-center items-center\">\n      <div\n        style=\"box-shadow: 0 5px 20px rgba(0, 0, 0, 8%);\"\n        class={`flex flex-col gap-3 border border_0000001a rounded-[20px] py-4 xs-px-4 px-6 ${\n          $isDarkMode ? \"bg-[#0f0f0f]\" : \"bg-white\"\n        }`}\n      >\n        <div class=\"text-center text_00000066 mb-2\">\n          {$t(\"Your code has been used by\")}\n          <span class=\" font-medium\">{referrals}</span>\n          {#if referrals > 1}\n            {$t(\"peoples\")}\n          {:else}\n            {$t(\"people\")}\n          {/if}\n        </div>\n\n        <div id=\"target-element\" class=\"card\">\n          {#if isNimbusVersion}\n            <div class=\"title_container\">\n              <img src={Logo} alt=\"logo\" loading=\"lazy\" decoding=\"async\" />\n            </div>\n          {/if}\n          <div class=\"body_container\">\n            <div class=\"title_wrapper\">\n              <div class=\"address\">\n                {shorterAddress(userAddress)}\n              </div>\n              <div class=\"type\">{$t(\"Inviter\")}</div>\n            </div>\n            <div class=\"qr_wrapper\">\n              <img src={qrImageDataUrl} alt=\"QR Code\" />\n            </div>\n            <div class=\"footer_wrapper\">\n              {$t(\"Track you investments in easy-mode\")}\n              {#if isNimbusVersion}{$t(\"with\")}\n                Nimbus{/if}\n            </div>\n          </div>\n        </div>\n\n        <div class=\"flex justify-center gap-6\">\n          <CopyToClipboard\n            text={link}\n            let:copy\n            on:copy={() => {\n              triggerToast(\"Successfully copied link invitation!\", \"success\");\n            }}\n          >\n            <div\n              class={`flex items-center gap-1 transition-all ease-in py-1 px-3 rounded-[10px] cursor-pointer flex-1 ${\n                $isDarkMode ? \"hover:bg-[#00000066]\" : \"hover:bg-[#eff0f4]\"\n              }`}\n              on:click={() => {\n                copy();\n              }}\n            >\n              <svg\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"24\"\n                height=\"24\"\n                viewBox=\"0 0 24 24\"\n                fill=\"none\"\n                stroke={`${$isDarkMode ? \"#cdcdcd\" : \"#00000099\"}`}\n                stroke-width=\"1.8\"\n                stroke-linecap=\"round\"\n                stroke-linejoin=\"round\"\n                class=\"tabler-icon tabler-icon-link\"\n                ><path d=\"M9 15l6 -6\" /><path\n                  d=\"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464\"\n                /><path\n                  d=\"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463\"\n                /></svg\n              >\n              <div class=\"text_00000066 text-base\">{$t(\"Link\")}</div>\n            </div>\n          </CopyToClipboard>\n\n          <div class=\"border-l-[1px] my-1\" />\n\n          <div\n            class={`flex items-center gap-1 transition-all ease-in py-1 px-2 rounded-[10px] cursor-pointer flex-1 ${\n              $isDarkMode ? \"hover:bg-[#00000066]\" : \"hover:bg-[#eff0f4]\"\n            }`}\n            on:click={downloadQRCode}\n          >\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              width=\"24\"\n              height=\"24\"\n              viewBox=\"0 0 24 24\"\n              fill=\"none\"\n              stroke={`${$isDarkMode ? \"#cdcdcd\" : \"#00000099\"}`}\n              stroke-width=\"1.8\"\n              stroke-linecap=\"round\"\n              stroke-linejoin=\"round\"\n              class=\"tabler-icon tabler-icon-download\"\n              ><path d=\"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2\" /><path\n                d=\"M7 11l5 5l5 -5\"\n              /><path d=\"M12 4l0 12\" /></svg\n            >\n            <div class=\"text_00000066 text-base\">{$t(\"Save\")}</div>\n          </div>\n\n          <div class=\"border-l-[1px] my-1\" />\n\n          <div\n            class={`flex items-center gap-1 transition-all ease-in py-1 px-2 rounded-[10px] cursor-pointer flex-1 ${\n              $isDarkMode ? \"hover:bg-[#00000066]\" : \"hover:bg-[#eff0f4]\"\n            }`}\n            on:click={copyQRCode}\n          >\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              width=\"24\"\n              height=\"24\"\n              viewBox=\"0 0 24 24\"\n              fill=\"none\"\n              stroke={`${$isDarkMode ? \"#cdcdcd\" : \"#00000099\"}`}\n              stroke-width=\"1.8\"\n              stroke-linecap=\"round\"\n              stroke-linejoin=\"round\"\n              class=\"tabler-icon tabler-icon-photo\"\n              ><path d=\"M15 8h.01\" /><path\n                d=\"M3 6a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v12a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3v-12z\"\n              /><path d=\"M3 16l5 -5c.928 -.893 2.072 -.893 3 0l5 5\" /><path\n                d=\"M14 14l1 -1c.928 -.893 2.072 -.893 3 0l3 3\"\n              /></svg\n            >\n            <div class=\"text_00000066 text-base\">{$t(\"Copy\")}</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</ErrorBoundary>\n\n<style>\n  .card {\n    border: 2px solid black;\n    border-radius: 12px;\n    overflow: hidden;\n    background: white;\n  }\n\n  .card .title_container {\n    padding: 12px 16px;\n    background-color: rgba(243, 244, 246, 1);\n    font-size: 14px;\n    line-height: 20px;\n  }\n\n  .card .title_container img {\n    height: 48px;\n    width: auto;\n    margin-left: -12px;\n  }\n\n  .card .body_container {\n    padding: 16px;\n    display: flex;\n    flex-direction: column;\n    gap: 16px;\n  }\n\n  .card .body_container .title_wrapper {\n    display: flex;\n    flex-direction: column;\n  }\n\n  .card .body_container .title_wrapper .address {\n    color: black;\n    font-size: 24px;\n    line-height: 32px;\n  }\n\n  .card .body_container .title_wrapper .type {\n    color: rgba(156, 163, 175, 1);\n  }\n\n  .card .body_container .qr_wrapper {\n    display: flex;\n    justify-content: center;\n  }\n\n  .card .body_container .qr_wrapper img {\n    width: 198px;\n    height: 198px;\n  }\n\n  .card .body_container .footer_wrapper {\n    font-size: 14px;\n    line-height: 20px;\n    color: rgba(156, 163, 175, 1);\n    margin-top: 16px;\n    font-weight: 500;\n  }\n\n  @media (max-width: 400px) {\n    .xs-px-4 {\n      padding-left: 12px;\n      padding-right: 12px;\n    }\n  }\n</style>\n"],"names":["t_1_value","ctx","dirty","set_data","t_1","Logo","insert","target","div","anchor","t0_value","t0","t1_value","div1","append","svg","path0","path1","path2","div0","t1","t2_value","t5_value","t7_value","t13_value","shorterAddress","t15_value","t18_value","t24_value","t28_value","create_if_block_2","create_if_block_1","create_if_block","attr","img","img_src_value","div20","div2","br","div19","div18","div3","span","div10","div9","div6","div4","div5","div7","div8","div17","div11","div13","svg0","div12","div14","div16","svg1","path3","path4","path5","path6","div15","current","t2","t5","t7","t13","t15","t18","if_block2","t24","t28","copy","triggerToast"],"mappings":"mZAuHa,IAAAA,EAAAC,KAAG,QAAQ,EAAA,gDAAXC,EAAA,IAAAF,KAAAA,EAAAC,KAAG,QAAQ,EAAA,KAAAE,EAAAC,EAAAJ,CAAA,iCAFX,IAAAA,EAAAC,KAAG,SAAS,EAAA,gDAAZC,EAAA,IAAAF,KAAAA,EAAAC,KAAG,SAAS,EAAA,KAAAE,EAAAC,EAAAJ,CAAA,sFASDK,EAAI,4HADhBC,EAEKC,EAAAC,EAAAC,CAAA,iCAcmB,IAAAC,EAAAT,KAAG,MAAM,EAAA,6BAAC;AAAA,uBACxB,oCADcC,EAAA,IAAAQ,KAAAA,EAAAT,KAAG,MAAM,EAAA,KAAAE,EAAAQ,EAAAD,CAAA,4DAuCOE,EAAAX,KAAG,MAAM,EAAA,ycAXlCA,EAAW,CAAA,EAAG,UAAY,WAAW,EAAA,yTAZhDA,EAAW,CAAA,EAAG,uBAAyB,oBAAmB,EAAA,EAAA,gBAAA,UAF9DK,EA0BKC,EAAAM,EAAAJ,CAAA,EAlBHK,EAgBAD,EAAAE,CAAA,EALGD,EAAuBC,EAAAC,CAAA,EAAAF,EAEtBC,EAAAE,CAAA,EAAAH,EAEAC,EAAAG,CAAA,SAEJJ,EAAsDD,EAAAM,CAAA,iEAXzClB,EAAW,CAAA,EAAG,UAAY,WAAW,qBAWZC,EAAA,IAAAU,KAAAA,EAAAX,KAAG,MAAM,EAAA,KAAAE,EAAAiB,EAAAR,CAAA,kHAvB7CX,EAAW,CAAA,EAAG,uBAAyB,oBAAmB,EAAA,EAAA,oFAzD/BS,EAAAT,KAAG,gBAAgB,EAAA,SAErDoB,EAAApB,KAAG,mBAAmB,EAAA,WACtBqB,EAAArB,KAAG,UAAU,EAAA,aAWXsB,EAAAtB,KAAG,4BAA4B,EAAA,4BAkBzBuB,EAAAC,GAAexB,EAAW,CAAA,CAAA,EAAA,YAEVyB,GAAAzB,KAAG,SAAS,EAAA,sBAM9B0B,GAAA1B,KAAG,oCAAoC,EAAA,+CAmEJ2B,GAAA3B,KAAG,MAAM,EAAA,2CA4BT4B,GAAA5B,KAAG,MAAM,EAAA,qCAvH5C,OAAAA,KAAY,EAAC6B,6BAQEC,GAAA,IAiBIC,GAAA/B,CAAA,+BAQhBA,EAAI,CAAA,iRAlCgBA,EAAS,CAAA,CAAA,m1BAsBvBA,EAAc,CAAA,CAAA,GAAAgC,EAAAC,EAAA,MAAAC,EAAA,6hBA6DblC,EAAW,CAAA,EAAG,UAAY,WAAW,EAAA,+TAVhDA,EAAW,CAAA,EAAG,uBAAyB,oBAAmB,EAAA,EAAA,gBAAA,maAoC/CA,EAAW,CAAA,EAAG,UAAY,WAAW,EAAA,4TAVhDA,EAAW,CAAA,EAAG,uBAAyB,oBAAmB,EAAA,EAAA,gBAAA,2MAxG9DA,EAAW,CAAA,EAAG,eAAiB,UAAS,EAAA,EAAA,gBAAA,yLAdhDK,EAgJKC,EAAA6B,EAAA3B,CAAA,EA7IHK,EAMKsB,EAAAC,CAAA,EALHvB,EAA+DuB,EAAAlB,CAAA,gBAC/DL,EAGKuB,EAAAxB,CAAA,gBAFuBC,EAAKD,EAAAyB,CAAA,uBAInCxB,EAqIKsB,EAAAG,CAAA,EApIHzB,EAmIKyB,EAAAC,CAAA,EA7HH1B,EAQK0B,EAAAC,CAAA,gBANH3B,EAA4C2B,EAAAC,CAAA,qCAQ9C5B,EAsBK0B,EAAAG,CAAA,yBAhBH7B,EAeK6B,EAAAC,CAAA,EAdH9B,EAKK8B,EAAAC,CAAA,EAJH/B,EAEK+B,EAAAC,CAAA,kBACLhC,EAAsC+B,EAAAE,EAAA,mBAExCjC,EAEK8B,EAAAI,EAAA,EADHlC,EAAyCkC,GAAAd,CAAA,UAE3CpB,EAIK8B,EAAAK,CAAA,yCAITnC,EA0FK0B,EAAAU,CAAA,uBArDHpC,EAAkCoC,EAAAC,EAAA,UAElCrC,EAsBKoC,EAAAE,CAAA,EAhBHtC,EAcAsC,EAAAC,CAAA,EAHGvC,EAAuDuC,EAAArC,EAAA,EAAAF,EAEtDuC,EAAApC,EAAA,EAAAH,EAAuBuC,EAAAnC,EAAA,UAE3BJ,EAAsDsC,EAAAE,EAAA,mBAGxDxC,EAAkCoC,EAAAK,EAAA,UAElCzC,EAwBKoC,EAAAM,CAAA,EAlBH1C,EAgBA0C,EAAAC,CAAA,EALG3C,EAAsB2C,EAAAC,EAAA,EAAA5C,EAErB2C,EAAAE,EAAA,EAAA7C,EAAsD2C,EAAAG,EAAA,EAAA9C,EAEtD2C,EAAAI,EAAA,UAEJ/C,EAAsD0C,EAAAM,EAAA,sCA7C5C7D,EAAc,CAAA,CAAA,eA0BdA,EAAU,CAAA,CAAA,mBApHW,CAAA8D,GAAA7D,EAAA,KAAAQ,KAAAA,EAAAT,KAAG,gBAAgB,EAAA,KAAAE,EAAAQ,EAAAD,CAAA,GAErD,CAAAqD,GAAA7D,EAAA,KAAAmB,KAAAA,EAAApB,KAAG,mBAAmB,EAAA,KAAAE,EAAA6D,EAAA3C,CAAA,GACtB,CAAA0C,GAAA7D,EAAA,KAAAoB,KAAAA,EAAArB,KAAG,UAAU,EAAA,KAAAE,EAAA8D,EAAA3C,CAAA,GAWX,CAAAyC,GAAA7D,EAAA,KAAAqB,KAAAA,EAAAtB,KAAG,4BAA4B,EAAA,KAAAE,EAAA+D,EAAA3C,CAAA,iBACJtB,EAAS,CAAA,CAAA,uEAiB9B,CAAA8D,GAAA7D,EAAA,IAAAsB,KAAAA,EAAAC,GAAexB,EAAW,CAAA,CAAA,EAAA,KAAAE,EAAAgE,GAAA3C,CAAA,GAEV,CAAAuC,GAAA7D,EAAA,KAAAwB,MAAAA,GAAAzB,KAAG,SAAS,EAAA,KAAAE,EAAAiE,GAAA1C,EAAA,yBAGrBzB,EAAc,CAAA,CAAA,mBAGvB,CAAA8D,GAAA7D,EAAA,KAAAyB,MAAAA,GAAA1B,KAAG,oCAAoC,EAAA,KAAAE,EAAAkE,GAAA1C,EAAA,EACpB2C,EAAA,EAAArE,EAAAC,CAAA,4BAQhBD,EAAI,CAAA,2EAiDGA,EAAW,CAAA,EAAG,UAAY,WAAW,wBASZ,CAAA8D,GAAA7D,EAAA,KAAA0B,MAAAA,GAAA3B,KAAG,MAAM,EAAA,KAAAE,EAAAoE,GAAA3C,EAAA,yHAnB7C3B,EAAW,CAAA,EAAG,uBAAyB,oBAAmB,EAAA,EAAA,2DAoC/CA,EAAW,CAAA,EAAG,UAAY,WAAW,wBAWZ,CAAA8D,GAAA7D,EAAA,KAAA2B,MAAAA,GAAA5B,KAAG,MAAM,EAAA,KAAAE,EAAAqE,GAAA3C,EAAA,yHArB7C5B,EAAW,CAAA,EAAG,uBAAyB,oBAAmB,EAAA,EAAA,yIAxG9DA,EAAW,CAAA,EAAG,eAAiB,UAAS,EAAA,EAAA,++CAkDlCwE,EAAI,UARNC,EAAa,uCAAwC,SAAS"}